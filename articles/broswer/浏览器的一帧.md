---
title: 浏览器在一帧内做了什么
tags: [浏览器, 碎片]
---

网页不仅仅应该快速的加载, 更需要快速的运行

浏览器的刷新频率是 60hz, 也就是一秒刷新 60 次, 每一次的间隔就是 16 ms `1000/60`

浏览器一帧的动作

1. 浏览器的事件处理
2. 执行宏任务
3. 执行微任务
4. 判断 document 是否需要更新. 
5. 然后判断是否有 `resize` 或者 `scroll`, 有的话会去触发事件, 所以 `resize` 和 `scroll` 事件也是至少 16ms 才会触发一次, 并且自带节流功能
6. 判断是否触发了 media query
7. 更新动画并且发送事件
8. 判断是否有全屏操作事件
9. 执行 `requestAnimationFrame` 回调
10. 执行 `IntersectionObserver` 回调, 该方法用于判断元素是否可见, 可以用于懒加载上, 但是兼容性不好
11. 更新界面
12. 以上就是一帧中可能会做的事情. 如果在一帧中有空闲时间, 就会去执行 `requestIdleCallback` 回调 `React 的 fiber 架构`

浏览器在一帧里面会合并 DOM 的更新

共勉